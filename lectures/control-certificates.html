
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Control certificate functions &#8212; Linear Multivariable Control</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Introduction to optimization" href="optimization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/class_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Linear Multivariable Control</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Linear Multivariable Control
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../logistics/overview.html">
   Course information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../logistics/schedule.html">
   Week-by-week schedule
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Homework
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/hw_solution_writeup.html">
   Homework solution and worked example guidelines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/hw01.html">
   Homework 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/hw02.html">
   Homework 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../homework/hw03.html">
   Homework 3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Project
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../project/project.html">
   Project
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="state-space.html">
   State-space representation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optimization.html">
   Introduction to optimization
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Control certificate functions
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/UW-CTRL/lmc-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/UW-CTRL/lmc-book/issues/new?title=Issue%20on%20page%20%2Flectures/control-certificates.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/lectures/control-certificates.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-stability">
   Types of stability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-for-stability">
   Checking for stability
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-systems">
     Linear systems
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lyapunov-functions">
     Lyapunov functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-lyapunov-functions-clf">
   Control Lyapunov functions (CLF)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clf-controller">
     CLF controller
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-invariant-set">
   Control Invariant Set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#barrier-functions">
   Barrier functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-barrier-functions-cbfs">
   Control Barrier Functions (CBFs)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-valid-cbfs">
     Finding valid CBFs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbf-safety-filter">
   CBF safety filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbf-clf-controller">
   CBF-CLF controller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-topics-and-extra-readings">
   Other topics and extra readings
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Control certificate functions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#types-of-stability">
   Types of stability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-for-stability">
   Checking for stability
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-systems">
     Linear systems
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lyapunov-functions">
     Lyapunov functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-lyapunov-functions-clf">
   Control Lyapunov functions (CLF)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clf-controller">
     CLF controller
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-invariant-set">
   Control Invariant Set
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#barrier-functions">
   Barrier functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#control-barrier-functions-cbfs">
   Control Barrier Functions (CBFs)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-valid-cbfs">
     Finding valid CBFs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbf-safety-filter">
   CBF safety filter
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbf-clf-controller">
   CBF-CLF controller
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-topics-and-extra-readings">
   Other topics and extra readings
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="control-certificate-functions">
<h1>Control certificate functions<a class="headerlink" href="#control-certificate-functions" title="Permalink to this headline">#</a></h1>
<p>In this section, we describe control synthesis techniques for ensuring the stability and safety of dynamical systems. In particular, we consider using scalar functions that serve as <em>certificates</em> for certain properties of a dynamical system under control.
Namely, we consider:</p>
<ul class="simple">
<li><p><strong>Control Lyapunov Functions</strong> (CLF) to certify stabilizability</p></li>
<li><p><strong>Control Barrier Functions</strong> (CBF) to certify safety</p></li>
</ul>
<p>The term <em>certificate</em> is used in the literature, particularly in formal methods and control theory contexts, where such functions are interpreted as evidence that a control policy exists to guarantee a certain property.</p>
<p>First, we recap Lyapunov theory and stability, then extend the ideas to <em>control</em> Lyapunov theory, and then show that a natural extension to Lyapunov theory is <em>barrier</em> functions and <em>control</em> barrier functions (CBFs).
Then we show that for control affine dynamics, synthesizing a controller that satisfies the CLF and CBF constraints results in a quadratic program, which is a convex optimization problem that is straightforward to solve.</p>
<section id="types-of-stability">
<h2>Types of stability<a class="headerlink" href="#types-of-stability" title="Permalink to this headline">#</a></h2>
<p>Consider an LTI system <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span>. Let <span class="math notranslate nohighlight">\(x^\mathrm{eq}\)</span> be an equilibrium state, where <span class="math notranslate nohighlight">\(f(x^\mathrm{eq}) = 0\)</span>.
Then the equilibrium is:</p>
<ul class="simple">
<li><p><strong>(Lyapunov) stable</strong>: <span class="math notranslate nohighlight">\(\forall\epsilon&gt;0, \exists\delta&gt;0\)</span> such that <span class="math notranslate nohighlight">\(|x(0)-x^\mathrm{eq}|&lt;\delta \Rightarrow |x(t)-x^\mathrm{eq}|&lt;\epsilon, \forall t\geq0\)</span></p></li>
<li><p><strong>Asymptotically stable</strong>: <span class="math notranslate nohighlight">\(\forall\epsilon&gt;0, \exists\delta&gt;0\)</span>, such that <span class="math notranslate nohighlight">\(|x(0)-x^\mathrm{eq}|&lt;\delta \Rightarrow \lim_{t\to\infty}|x(t)-x^\mathrm{eq}|=0\)</span></p></li>
<li><p><strong>Exponentially stable</strong>: <span class="math notranslate nohighlight">\(\forall\epsilon&gt;0, \exists\delta&gt;0, K&gt;0\)</span>, such that <span class="math notranslate nohighlight">\(|x(0)-x^*|&lt;\delta\)</span>, <span class="math notranslate nohighlight">\(|x(t)-x^*|\leq \alpha e^{-\lambda t}|x(0)-x^*|\)</span>, <span class="math notranslate nohighlight">\(\forall t\geq 0\)</span></p></li>
</ul>
<p>These above types of stability are in regard to an equilibrium state—whether or not the system remains close or converges to the equilibrium state if the initial state were to be close to it.
As such, these stability definitions describe <em>local</em> stability properties.</p>
<aside class="margin sidebar">
<p class="sidebar-title">Contraction theory</p>
<p>For the interested reader, <em>contraction theory</em> is a control certificate technique for determining the global stability of a system. Check out <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0005109898000193">this paper</a>, which introduces the idea of contraction analysis, and <a class="reference external" href="https://arxiv.org/abs/1503.03144">this paper</a> for control feedback design using contraction metrics.</p>
</aside>
<p>For <em>any</em> initial conditions, not just ones close to the equilibrium state of interest, then this refers to <em>global</em> stability, which is a much stronger condition and often harder to prove.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Definition</strong></p></th>
<th class="head"><p><strong>Notes</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Lyapunov Stability</strong></p></td>
<td><p>Trajectories stay close to equilibrium if started nearby</p></td>
<td><p>No guarantee of convergence</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Asymptotic Stability</strong></p></td>
<td><p>Trajectories stay close <strong>and</strong> converge to equilibrium</p></td>
<td><p>Includes Lyapunov stability</p></td>
</tr>
<tr class="row-even"><td><p><strong>Exponential Stability</strong></p></td>
<td><p>Trajectories converge to equilibrium <strong>at an exponential rate</strong></p></td>
<td><p>Stronger than asymptotic stability</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Local Stability</strong></p></td>
<td><p>Stability properties hold <strong>near</strong> the equilibrium</p></td>
<td><p>Common in nonlinear systems</p></td>
</tr>
<tr class="row-even"><td><p><strong>Global Stability</strong></p></td>
<td><p>Stability properties hold <strong>for all</strong> initial conditions</p></td>
<td><p>Often harder to prove</p></td>
</tr>
</tbody>
</table>
</section>
<section id="checking-for-stability">
<h2>Checking for stability<a class="headerlink" href="#checking-for-stability" title="Permalink to this headline">#</a></h2>
<section id="linear-systems">
<h3>Linear systems<a class="headerlink" href="#linear-systems" title="Permalink to this headline">#</a></h3>
<p>There are techniques for determining whether a system is stable.
If the system is linear (assuming no control input), that is, we have <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span>, then system is (expoentially) stable if the real parts of all the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> are strictly negative.</p>
<div class="admonition-pause-and-think admonition">
<p class="admonition-title">Pause and think</p>
<p>Why is this the case?</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution to <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span></p>
<p>Recall that the solution to <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span> is <span class="math notranslate nohighlight">\(x(t) = Ve^{Dt}V^{-1}x(0)\)</span> where <span class="math notranslate nohighlight">\(A = VDV^{-1}\)</span> is the diagonalization of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(x(0)\)</span> is the initial condition. Whether <span class="math notranslate nohighlight">\(x(t)\)</span> grows or decays exponentially depends on <span class="math notranslate nohighlight">\(D\)</span>, the eigenvalues. If the real parts of all eigenvalues are negative, then <span class="math notranslate nohighlight">\(e^{Dt}\)</span> will decay.</p>
</div>
<div class="admonition-pause-and-think admonition">
<p class="admonition-title">Pause and think</p>
<p>What about for discrete-time linear dynamics <span class="math notranslate nohighlight">\(x_{t+1} = A x_t\)</span>?</p>
</div>
<p><a class="reference external" href="https://faculty.washington.edu/chx/teaching/me547/stability_eigenvalue/">Professor Xu Chen’s ME 547 notes</a> provide more information regarding the stability of LTI systems.</p>
</section>
<section id="lyapunov-functions">
<h3>Lyapunov functions<a class="headerlink" href="#lyapunov-functions" title="Permalink to this headline">#</a></h3>
<p>For nonlinear systems, determining its stability is generally challenging. However, Lyapunov theory provides a general approach to proving the stability of a nonlinear system. At a high-level, if we can find a Lyapunov function such that a set of conditions are true, then the system is stable. The Lyapunov conditions are somewhat straightforward, and avoids the need to explicitly compute solution of system responses. The challenge is finding such a Lyapunov function. But if one can be found, then the existence of it is a certificate for stability.</p>
<div class="admonition-theorem-lyapunov-function admonition">
<p class="admonition-title">Theorem (Lyapunov function)</p>
<p>Given a general nonlinear dynamical system <span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span>, <span class="math notranslate nohighlight">\(x \in \mathcal{X} \subset \mathbb{R}^n\)</span>.
Without loss of generality, let <span class="math notranslate nohighlight">\(x=0\)</span> be an equilibrium state.
Let <span class="math notranslate nohighlight">\(V:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> be a scalar function that is continuous, and has continuous first derivatives.
Then the origin <span class="math notranslate nohighlight">\(x=0\)</span> is Lyapunov stable if:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V(0) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(V(x) &gt; 0 \, \forall x\in\mathcal{X} \setminus \{ 0\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\dot{V}(x) = \nabla V(x)^Tf(x) \leq 0\, \forall  x\in\mathcal{X}\)</span></p></li>
</ul>
</div>
<p>For the last condition, if the inequality was a strict inequality, then we would have asymptotic stability. If instead the RHS was <span class="math notranslate nohighlight">\(-\alpha V(x)\)</span>, then we would have exponential stability with a decay rate of <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>In the case of linear systems <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span>, a good Lyapunov candidate is a quadratic function <span class="math notranslate nohighlight">\(V(s) = x^TPx\)</span> where <span class="math notranslate nohighlight">\(P\)</span> is positive definite, i.e., <span class="math notranslate nohighlight">\(P=P^T, P\succ 0\)</span>.
Show that for <span class="math notranslate nohighlight">\(V(x)\)</span> to be a valid Lyapunov function, we must have <span class="math notranslate nohighlight">\(A^TP + PA \preceq 0\)</span>.</p>
</div>
<div class="admonition-theorem-lyapunov-stability-theorem-for-linear-systems admonition">
<p class="admonition-title">Theorem (Lyapunov stability theorem for linear systems)</p>
<p>For a linear system <span class="math notranslate nohighlight">\(\dot{x} = Ax\)</span>, the origin <span class="math notranslate nohighlight">\(x=0\)</span> is asymptotically stable if and only if for any symmetric positive definite matrix <span class="math notranslate nohighlight">\(Q\)</span>, the Lyapunov equation</p>
<div class="math notranslate nohighlight">
\[ A^TP + PA = -Q\]</div>
<p>has a unique positive definite solution <span class="math notranslate nohighlight">\(P\succ 0\)</span>, <span class="math notranslate nohighlight">\(P^T = P\)</span>.</p>
</div>
<p>Intuitively, the Lyapunov function can be interpreted as as an energy-like function of the dynamics. If such an energy-like function can be found and shown to decay over time, then the system would “run out of energy” and settle to the equilibrium point. Of course, not all dynamical systems are rooted in mechanical systems where energy has a physical meaning. But for mechanical systems, deriving the energy of the system is often a good place to start when finding a Lyapunov function candidate.</p>
</section>
</section>
<section id="control-lyapunov-functions-clf">
<h2>Control Lyapunov functions (CLF)<a class="headerlink" href="#control-lyapunov-functions-clf" title="Permalink to this headline">#</a></h2>
<p>So far, we have been considering stability for dynamical systems without input.
But what if a system is naturally unstable (i.e., zero control input), but for certain choices of control input <span class="math notranslate nohighlight">\(u\)</span>, the system can be stable. In other words, there could be values of <span class="math notranslate nohighlight">\(u\)</span> such that the Lyapunov conditions are met.
As such, a natural extension to Lyapunov theory is <em>Control</em> Lyapunov theory. The following definition looks very similar to the definition of a Lyapunov function.</p>
<div class="admonition-theorem-control-lyapunov-function admonition">
<p class="admonition-title">Theorem (Control Lyapunov function)</p>
<p>Given a general nonlinear dynamical system <span class="math notranslate nohighlight">\(\dot{x} = f(x, u)\)</span>, <span class="math notranslate nohighlight">\(x \in \mathcal{X} \subset \mathbb{R}^n\)</span>, <span class="math notranslate nohighlight">\(u\in\mathcal{U} \subset\mathbb{R}^m\)</span>.
Without loss of generality, let <span class="math notranslate nohighlight">\(x=0\)</span> be an equilibrium state.
Let <span class="math notranslate nohighlight">\(V:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> be a scalar function that is continuous, and has continuous first derivatives.
Then the origin <span class="math notranslate nohighlight">\(x=0\)</span> is Lyapunov stable if:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V(0) = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(V(x) &gt; 0 \, \forall x\in\mathcal{X} \setminus \{ 0\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\min_{u\in \mathcal{U}}\nabla V(x)^Tf(x,u) \leq 0\, \forall  x\in\mathcal{X}\)</span></p></li>
</ul>
</div>
<p>In the last condition, the interpretation is that there exists a control <span class="math notranslate nohighlight">\(u\in\mathcal{U}\)</span> that satisfies the inequality <span class="math notranslate nohighlight">\(\nabla V(x)^Tf(x,u) \leq 0\)</span> for all <span class="math notranslate nohighlight">\(x\)</span> in the domain.
Likewise as before, we can also have asumptotic and exponential stability by slightly modifying the last condition.</p>
<p>So if we can find a valid CLF, then we know that there is always a control <span class="math notranslate nohighlight">\(u\)</span> that ensures that our system will be stable.</p>
<section id="clf-controller">
<h3>CLF controller<a class="headerlink" href="#clf-controller" title="Permalink to this headline">#</a></h3>
<p>Suppose you have a nominal controller for your system. It does not matter how this nominal controller is synthesized, but you know that at any time <span class="math notranslate nohighlight">\(t\)</span> and state <span class="math notranslate nohighlight">\(x\)</span>, the nominal controller spits out <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span>.
However, to ensure the system remains stable about the equilibrium state, or ensure that the system converges to an equilibrium state, we can adjust <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span> slightly to make sure that the CLF conditions are satisfies. In particular, we want to adjust <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span> as little as possible since <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span> is computed from some nominal controller that presumable encodes important objectives relevant to the task.
As such, we can frame this as an optimization problem:</p>
<div class="math notranslate nohighlight" id="equation-eq-clf-optimization">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-clf-optimization" title="Permalink to this equation">#</a></span>\[\begin{split}u^\star = &amp;\underset{u}{\text{argmin}} \: \| u - u_\mathrm{nom}\|_2^2\\
&amp;\text{subj. to} \:\: \nabla V(x)^Tf(x,u) \leq 0\end{split}\]</div>
<p>Note, we can change the inequality constraint slightly to reflect asymptotic and exponential stability.</p>
<p>For general nonlinear dynamics, the constraint would be nonlinear, potentially non-convex.
Thus making the constraint in <a class="reference internal" href="#equation-eq-clf-optimization">(2)</a> a challenging optimization problem to solve. However, for control affine systems, where the dynamics can be expressed as:</p>
<div class="math notranslate nohighlight">
\[\dot{x} = f(x) + g(x)u\]</div>
<p>the constraint in <a class="reference internal" href="#equation-eq-clf-optimization">(2)</a> becomes linear in <span class="math notranslate nohighlight">\(u\)</span>, making the optimization problem a quadratic program (QP). Quadratic programs are convex optimization problems and can be solved efficiently using standard solvers.</p>
<div class="admonition-example-control-lyapunov-function-for-a-nonlinear-system admonition">
<p class="admonition-title">Example: Control Lyapunov Function for a Nonlinear System</p>
<p>Consider the nonlinear dynamical system:</p>
<div class="math notranslate nohighlight">
\[
\dot{x}_1 = x_2, \quad \dot{x}_2 = -x_1 + u
\]</div>
<p>This system represents a simple pendulum with control input <span class="math notranslate nohighlight">\( u \)</span>. We aim to stabilize the system at the origin <span class="math notranslate nohighlight">\( (x_1, x_2) = (0, 0) \)</span>.</p>
<p>A natural choice for a Lyapunov function is the total energy of the system:</p>
<div class="math notranslate nohighlight">
\[
V(x) = \frac{1}{2}x_1^2 + \frac{1}{2}x_2^2
\]</div>
<p>This function is positive definite and radially unbounded. Its derivative along the system’s trajectories is:</p>
<div class="math notranslate nohighlight">
\[
\dot{V}(x) = \nabla V(x)^T f(x, u) = x_1 \dot{x}_1 + x_2 \dot{x}_2 = x_1 x_2 + x_2(-x_1 + u)
\]</div>
<p>Simplifying:</p>
<div class="math notranslate nohighlight">
\[
\dot{V}(x) = x_2(-x_1 + x_1 + u) = x_2 u
\]</div>
<p>To ensure <span class="math notranslate nohighlight">\( \dot{V}(x) \leq 0 \)</span>, we choose a control input <span class="math notranslate nohighlight">\( u \)</span> such that:</p>
<div class="math notranslate nohighlight">
\[
u = -kx_2, \quad k &gt; 0
\]</div>
<p>Substituting this into <span class="math notranslate nohighlight">\( \dot{V}(x) \)</span>:</p>
<div class="math notranslate nohighlight">
\[
\dot{V}(x) = x_2(-kx_2) = -k x_2^2
\]</div>
<p>Since <span class="math notranslate nohighlight">\( k &gt; 0 \)</span>, <span class="math notranslate nohighlight">\( \dot{V}(x) \leq 0 \)</span>, and the system is Lyapunov stable. This demonstrates that <span class="math notranslate nohighlight">\( V(x) \)</span> is a valid control Lyapunov function for the given system.</p>
</div>
</section>
</section>
<section id="control-invariant-set">
<h2>Control Invariant Set<a class="headerlink" href="#control-invariant-set" title="Permalink to this headline">#</a></h2>
<p>It turns out that the sub-level sets of a (control) Lyapunov function are forward <em>(control) invariant sets</em>, which are sets where if the system starts inside that set, it will remain inside that set for all future times.
For <em>control</em> invariant sets, there is an additional “there exists a control” clause: A set is forward control invariant if the system starts inside that set, there exists a control that will allow the system to remain inside that set for all future times.</p>
<p>Mathematically, <span class="math notranslate nohighlight">\(\mathcal{C} = \{ x \mid V(x) \leq c\}\)</span> is the sub-level set thresholded by <span class="math notranslate nohighlight">\(c\)</span>, and we are claiming that <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> is forward (control) invariant.
Intuitively, since <span class="math notranslate nohighlight">\(\dot{V}(x) \leq 0\)</span>, the largest value <span class="math notranslate nohighlight">\(V\)</span> attains is <span class="math notranslate nohighlight">\(V(x(0))\)</span> and any future <span class="math notranslate nohighlight">\(x\)</span>, we must have <span class="math notranslate nohighlight">\(V(x) \leq V(x(0))\)</span>. Thus if we set <span class="math notranslate nohighlight">\(c=V(x(0))\)</span>, then we must have <span class="math notranslate nohighlight">\(x\in \mathcal{C}\)</span> for all future times.</p>
</section>
<section id="barrier-functions">
<h2>Barrier functions<a class="headerlink" href="#barrier-functions" title="Permalink to this headline">#</a></h2>
<p>The previous discussion about stability and Lyapunov functions was centered about the idea that the system would (hopefully) eventually converge to an equilibrium state.
What if instead, rather than converge an equilibrium state, we desired the system remained inside a set. It does not matter where inside the set the system is as long as it is inside it. Roughly speaking, you can view this as stability to not a state but to a set.</p>
<p>We can make some small modification to the ideas surrounding Lyapunov theory to consider containment within a desired set. A natural and common choice of the desired set is the <em>safe set</em>, the set of states that is deemed safe for the system to operate in. For example, the set of states that are not in collision to obstacles.</p>
<p>Let <span class="math notranslate nohighlight">\(b:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> be a scalar function, and suppose we have dynamics <span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span>. Define <span class="math notranslate nohighlight">\(\mathcal{S} = \{ x \mid b(x) \geq 0\}\)</span> as the “safe set”. Then if <span class="math notranslate nohighlight">\(b(x(0)) \geq 0\)</span> (i.e., the system is initially safe), then if <span class="math notranslate nohighlight">\(\nabla b(x)^T f(x) \geq 0\)</span> whenever <span class="math notranslate nohighlight">\(b(x) = 0\)</span>, then we call <span class="math notranslate nohighlight">\(b\)</span> a <em>barrier function</em>. This condition will ensure that if the system initially starts inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, then it will remain inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>. Intuitively, whenever the system reaches the boundary of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> where <span class="math notranslate nohighlight">\(b(x) = 0\)</span>, since <span class="math notranslate nohighlight">\(\nabla b(x)^T f(x) \geq 0\)</span>, then the barrier value must either increase (i.e., move away from the boundary and further back into <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>) or remain at the boundary (i.e., stay there or move along the boundary of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.) As such, <span class="math notranslate nohighlight">\(b\)</span> acts like “barrier” that prevents the system from exiting <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
</section>
<section id="control-barrier-functions-cbfs">
<h2>Control Barrier Functions (CBFs)<a class="headerlink" href="#control-barrier-functions-cbfs" title="Permalink to this headline">#</a></h2>
<aside class="margin sidebar">
<p class="sidebar-title">Safe Autonomy with Control Barrier Functions</p>
<p>The textbook <a class="reference external" href="https://link.springer.com/book/10.1007/978-3-031-27576-0">Safe Autonomy with Control Barrier Functions
</a> by Wei Xiao, Christos G. Cassandras, Calin Belta offers an introduction and overview of control barrier functions and their use in safe autonomy.</p>
</aside>
<p>We can extend the idea of barrier functions to <em>control</em> barrier functions (CBFs), in a similar way we saw with Lyapunov and control Lyapunov functions.</p>
<p>We change the barrier condition described above slightly to account for the control input.
Let <span class="math notranslate nohighlight">\(b:\mathbb{R}^n \rightarrow \mathbb{R}\)</span> be a scalar function, and suppose we have dynamics <span class="math notranslate nohighlight">\(\dot{x} = f(x,u)\)</span>. Define <span class="math notranslate nohighlight">\(\mathcal{S} = \{ x \mid b(x) \geq 0\}\)</span> as the “safe set”.
We see that if <span class="math notranslate nohighlight">\(\max_{u \in \mathcal{U}} \nabla b(x)^T f(x,u) \geq 0\)</span> whenever <span class="math notranslate nohighlight">\(b(x) = 0\)</span>, then, if <span class="math notranslate nohighlight">\(b(x(0)) \geq 0\)</span>, then the system will always remain inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>. Note that having the inequality on the right be 0 imposes the least restriction on the system—it can so absolutely anything inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, but at the boundary, we must have <span class="math notranslate nohighlight">\(\max_{u \in \mathcal{U}} \nabla b(x)^T f(x,u) \geq 0\)</span>.</p>
<p>One may want a more gradual constraint on the system as it approaches the boundary. Intuitively, the closer the system approaches the boundary, the more restrictions there should be on the motion such that when the system is at the boundary, we must have <span class="math notranslate nohighlight">\(\max_{u \in \mathcal{U}} \nabla b(x)^T f(x,u) \geq 0\)</span>, which is the condition above. This makes practical sense—when the system is far away from the boundary of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, it should have a lot of freedom on its motion, including moving towards the boundary. But since the system is far away from the boundary, moving towards the boundary does not pose much risk. But as the system gets closer and closer to the boundary, the freedom in its motion should be reduced accordingly, for instance, the system should begin to slow down and/or steer away from the boundary.
To achieve this behavior, we introduce a different term on the RHS of the inequality. First we introduce the following definition.</p>
<div class="admonition-class-mathcal-k-and-extended-class-mathcal-k-functions admonition">
<p class="admonition-title">Class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> and extended class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> functions</p>
<p>A Lipschitz continuous function <span class="math notranslate nohighlight">\(\alpha : [0, a) \rightarrow [0,\infty)\)</span>, <span class="math notranslate nohighlight">\(a &gt; 0\)</span> is said to belong to class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> if it is strictly increasing and <span class="math notranslate nohighlight">\(\alpha(0) = 0\)</span>. Moreover, <span class="math notranslate nohighlight">\(\alpha : [−b, a) \rightarrow [−\infty,\infty)\)</span>, <span class="math notranslate nohighlight">\(a &gt; 0\)</span>, <span class="math notranslate nohighlight">\(b &gt; 0\)</span> belongs to extended class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> if it is strictly increasing and <span class="math notranslate nohighlight">\(\alpha(0) = 0\)</span>.</p>
</div>
<p>Intuitively, a class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> or extended class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> functions are monotonically increasing functions that are 0 at 0. A common example include <span class="math notranslate nohighlight">\(\alpha(x) = ax\)</span>.</p>
<p>Now we formally define a control barrier function</p>
<div class="admonition-definition-control-barrier-function admonition">
<p class="admonition-title">Definition (Control barrier function)</p>
<p>Given a set <span class="math notranslate nohighlight">\(\mathcal{S} = \{ x \mid b(x) \geq 0\}\)</span> where <span class="math notranslate nohighlight">\(b:\mathbb{R}^n \rightarrow \mathbb{R}\)</span>. Then <span class="math notranslate nohighlight">\(b\)</span> is a control barrier function for a system <span class="math notranslate nohighlight">\(\dot{x} = f(x,u)\)</span> if there exists a class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> function <span class="math notranslate nohighlight">\(\alpha\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-eq-cbf">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-cbf" title="Permalink to this equation">#</a></span>\[\max_{u\in\mathcal{U}} \nabla b(x)^Tf(x,u)  \geq -\alpha(b(x)) , \quad \forall \: x\in\mathcal{S}\]</div>
</div>
<p>This definition is similar CLFs introduced beforehand, but instead of 0 on the RHS, we have <span class="math notranslate nohighlight">\(-\alpha(b(x))\)</span> which provides the behavior we want where we gradually restrict the motion of the system as it approaches the boundary of <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.
The <span class="math notranslate nohighlight">\(\max\)</span> operation there is to ensure that there exists at least one control <span class="math notranslate nohighlight">\(u\in\mathcal{U}\)</span> that satisfies the inequality.</p>
<p>If we can find such a function <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> that satisfy the CBF inequality over the domain, then we can guarantee that if the system starts inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, then it will remain inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> for all future time.</p>
<section id="finding-valid-cbfs">
<h3>Finding valid CBFs<a class="headerlink" href="#finding-valid-cbfs" title="Permalink to this headline">#</a></h3>
<p>In general, finding a valid CBF (and CLF for that matter) is challenging. One may construct one based on deep understanding of the system, or develop techniques to synthesize one. Later we will learn about HJ reachability and HJ reachability value functions are valid CBFs.</p>
</section>
</section>
<section id="cbf-safety-filter">
<h2>CBF safety filter<a class="headerlink" href="#cbf-safety-filter" title="Permalink to this headline">#</a></h2>
<p>The CBF discussion so far is centered about the definition, but we have yet to compute a controller that would ensure the system remains inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.
To ensure the system remains inside <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, we need to guarantee that the control input satisfies the inequality in <a class="reference internal" href="#equation-eq-cbf">(3)</a> at all times. Since a valid CBF ensures the existence of at least one control input that meets this condition, we can leverage this property. Simultaneously, we often have a nominal controller designed to achieve specific objectives or tasks. Therefore, we aim to balance following the nominal controller’s guidance while ensuring the system’s safety by staying within <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
<p>This trade-off can be formulated as an optimization problem:</p>
<div class="math notranslate nohighlight" id="equation-eq-cbf-optimization">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-cbf-optimization" title="Permalink to this equation">#</a></span>\[\begin{split}u^\star = &amp;\underset{u}{\text{argmin}} \: \| u - u_\mathrm{nom}\|_2^2\\
&amp;\text{subj. to} \:\: \nabla b(x)^Tf(x,u) \geq -\alpha(b(x))\end{split}\]</div>
<p>For systems with <em>control affine</em> dynamics, this optimization problem becomes a quadratic program (QP), which is a convex optimization problem that can be solved efficiently using standard solvers.</p>
<p>Like what we saw with CLFs, we can pose this as an optimization problem,</p>
<div class="math notranslate nohighlight" id="equation-eq-cbf-optimization">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-cbf-optimization" title="Permalink to this equation">#</a></span>\[\begin{split}u^\star = &amp;\underset{u}{\text{argmin}} \: \| u - u_\mathrm{nom}\|_2^2\\
&amp;\text{subj. to} \:\: \nabla b(x)^Tf(x,u) \geq -\alpha(b(x))\end{split}\]</div>
<p>If the dynamics are <em>control affine</em>, then <a class="reference internal" href="#equation-eq-cbf-optimization">(5)</a> is a quadratic program and can be solved very efficiently.</p>
<div class="admonition-example-control-barrier-function-for-a-nonlinear-system admonition">
<p class="admonition-title">Example: Control Barrier Function for a Nonlinear System</p>
<p>Consider the nonlinear system:</p>
<div class="math notranslate nohighlight">
\[
\dot{x}_1 = x_2, \quad \dot{x}_2 = -x_1 + u
\]</div>
<p>This system represents a simple pendulum with control input <span class="math notranslate nohighlight">\(u\)</span>. We aim to ensure that the system remains within a safe set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> defined as:</p>
<div class="math notranslate nohighlight">
\[
\mathcal{S} = \{ x \mid b(x) \geq 0 \}, \quad b(x) = 1 - x_1^2 - x_2^2
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> is a circular region centered at the origin with radius 1. The goal is to ensure the system stays within this region.</p>
<p>The gradient of <span class="math notranslate nohighlight">\(b(x)\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla b(x) = \begin{bmatrix} -2x_1 \\ -2x_2 \end{bmatrix}
\end{split}\]</div>
<p>The system dynamics are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\dot{x} = \begin{bmatrix} x_2 \\ -x_1 + u \end{bmatrix}
\end{split}\]</div>
<p>Substituting the dynamics into <span class="math notranslate nohighlight">\(\nabla b(x)^T f(x, u)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla b(x)^T f(x, u) = \begin{bmatrix} -2x_1 &amp; -2x_2 \end{bmatrix} \begin{bmatrix} x_2 \\ -x_1 + u \end{bmatrix}
\end{split}\]</div>
<p>Simplifying:</p>
<div class="math notranslate nohighlight">
\[
\nabla b(x)^T f(x, u) = -2x_1 x_2 - 2x_2(-x_1 + u) = -2x_1 x_2 + 2x_1 x_2 - 2x_2 u = -2x_2 u
\]</div>
<p>To satisfy the CBF condition:</p>
<div class="math notranslate nohighlight">
\[
-2x_2 u \geq -\alpha(b(x))
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha(b(x))\)</span> is a class <span class="math notranslate nohighlight">\(\mathcal{K}\)</span> function, e.g., <span class="math notranslate nohighlight">\(\alpha(b(x)) = kb(x)\)</span> with <span class="math notranslate nohighlight">\(k &gt; 0\)</span>. Substituting <span class="math notranslate nohighlight">\(\alpha(b(x))\)</span>:</p>
<div class="math notranslate nohighlight">
\[
-2x_2 u \geq -k(1 - x_1^2 - x_2^2)
\]</div>
<p>Rearranging:</p>
<div class="math notranslate nohighlight">
\[
u \leq \frac{k(1 - x_1^2 - x_2^2)}{2x_2}, \quad x_2 \neq 0
\]</div>
<p>To ensure safety, we solve the following quadratic program (QP):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
u^\star = &amp;\underset{u}{\text{argmin}} \: \| u - u_\mathrm{nom}\|_2^2\\
&amp;\text{subj. to} \:\: -2x_2 u \geq -k(1 - x_1^2 - x_2^2)
\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span> is a nominal control input designed for other objectives (e.g., stabilization). The QP adjusts <span class="math notranslate nohighlight">\(u_\mathrm{nom}\)</span> minimally to ensure the system remains within the safe set <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
</div>
<div class="admonition-pause-and-think admonition">
<p class="admonition-title">Pause and think</p>
<p>What are other choices of <span class="math notranslate nohighlight">\(\alpha\)</span> that we could use? What kind of behaviors would they induce?</p>
</div>
</section>
<section id="cbf-clf-controller">
<h2>CBF-CLF controller<a class="headerlink" href="#cbf-clf-controller" title="Permalink to this headline">#</a></h2>
<p>We can combine both the CLF and CBF constraints into a single optimization, where we seek to achieve both stability (or convergence to a goal state) and safety simultaneously.</p>
<div class="math notranslate nohighlight" id="equation-eq-cbf-clf-optimization">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-cbf-clf-optimization" title="Permalink to this equation">#</a></span>\[\begin{split}u^\star = &amp;\underset{u}{\text{argmin}} \: \| u - u_\mathrm{nom}\|_2^2\\
&amp;\text{subj. to} \:\: \nabla b(x)^Tf(x,u) \geq -\alpha(b(x))\\
&amp; \qquad \quad \:\:\: \nabla V(x)^Tf(x,u) \leq 0\end{split}\]</div>
<div class="admonition-pause-and-think admonition">
<p class="admonition-title">Pause and think</p>
<p>Are there any potential issues we may encounter when solving <a class="reference internal" href="#equation-eq-cbf-clf-optimization">(6)</a>? What could we do to address these issues?</p>
</div>
</section>
<section id="other-topics-and-extra-readings">
<h2>Other topics and extra readings<a class="headerlink" href="#other-topics-and-extra-readings" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Depending on the choice of your CLF/CBF for your given control affine dynamics <span class="math notranslate nohighlight">\(\dot{x} = f(x) + g(x)u\)</span>, you may find that for  <span class="math notranslate nohighlight">\(\nabla b(x)^Tg(x) = 0\)</span> for all <span class="math notranslate nohighlight">\(x\in\mathcal{X}\)</span>. This occurs when the relative degree of the CLF/CBF for yhr dynamics is greater than 1. In that case, you will need to either change your CLF/CBF to make the relatively gree 1, or apply <a class="reference external" href="https://ieeexplore.ieee.org/document/9516971">high-order CBFs</a>.</p></li>
<li><p>Finding a value CLF/CBF is not always straightforward and is challenging for general nonlinear systems. Recent work looks into parameterizing CLF/CBFs as deep neural networks and optimizing the network weights to ensure the CLF/CBF conditions are satisfied. Survey paper: <a class="reference external" href="https://ieeexplore.ieee.org/document/10015199">Neural CBFs and CLFs</a></p></li>
<li><p>Another way to come up with a CBF (and perhaps also a CLF) is to use human demonstrations as example trajectories satisfying a CBF. Then we can parameterize a CBF and optimize a set of parameters that best explains the data. Paper: <a class="reference external" href="https://arxiv.org/abs/2004.03315">Learning CBFs from demonstrations</a></p></li>
<li><p>Related to the above two points on learning CBFs data, this is a nice survey paper from IEEE Control Systems Magazine on <a class="reference external" href="https://ieeexplore.ieee.org/document/10266799">Data-Driven Safety Filters</a>.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="optimization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to optimization</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Karen Leung<br/>
  
      &copy; Copyright 2025.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>